<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="MicroPython for BeagleConnect Freedom">
  <meta name="generator" content="Hugo 0.87.0" />

  <title>Project Report for GSoC 2021 &middot; MicroPython for BeagleConnect Freedom</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/">GSoC 2021</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/journal/"><i class='fa fa-book fa-fw'></i>Journal</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/jadonk/beagleconnect" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Project Report for GSoC 2021</h1>
  <h2>MicroPython for BeagleConnect Freedom</h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Aug 2021</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/tags/iot">IOT</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/tags/beagleboard.org">BeagleBoard.org</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/tags/gsoc-2021">GSoC 2021</a>
    
  </div>
  
  

</div>

  <h2 id="table-of-contents">Table of contents</h2>
<ol>
<li>About</li>
<li>Introduction</li>
<li>Detailed Implementation
<ol>
<li>Flashing and validating the Zephyr port of MicroPython</li>
<li>GPIO Class</li>
<li>I2C Class</li>
<li>UART Class</li>
<li>SPI Class</li>
<li>Documentation:</li>
</ol>
</li>
<li>Benefits</li>
<li>Conclusion</li>
<li>Future Improvements</li>
<li>References</li>
</ol>
<h2 id="about">About</h2>
<ol>
<li>Student Name: Yadnik Bendale</li>
<li>Mentors: Jason Kridner, Deepak Khatri, Tim Orling</li>
<li>GSoC entry link: <a href="https://summerofcode.withgoogle.com/projects/#6316697687949312">https://summerofcode.withgoogle.com/projects/#6316697687949312</a></li>
<li>Blog link: <a href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/">https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/</a></li>
<li>Introductory video: <a href="https://www.youtube.com/watch?v=x1hBazDr2Bk">https://www.youtube.com/watch?v=x1hBazDr2Bk</a></li>
<li>Proposal link: <a href="https://elinux.org/BeagleBoard/GSoC_2021/Micropython_for_BeagleConnect_Freedom">https://elinux.org/BeagleBoard/GSoC_2021/Micropython_for_BeagleConnect_Freedom</a></li>
</ol>
<h2 id="introduction">Introduction</h2>
<p>BeagleConnect Freedom board is based on the Zephyr Project which is a scalable real-time operating system (RTOS). It has its main applications in the Internet of things and Industrial Internet of things domain.The board contains 2 mikroBUS connectors for connecting any of the hundreds of Click Board mikroBUS add-on devices.
Until this project BeagleConnect Freedom could only be operated using the Zephyr RTOS and Greybus protocol for various IOT applications.This project enables users to take MicroPython into use, using the zephyr port of MicroPython, increasing the versatility of BeagleConnect Freedom and making it more user friendly. Enabling users to write minimal code in MicroPython for interfacing various sensors, actuators and indicators.
The goal of the project intitially was to enable MicroPython and CircuitPython for BeagleConnect Freedom along with basic UART, GPIO, I2C, SPI, PWM, ADC drivers. As the project progressed, on discussion with mentors we decided to leave the CircuitPython port for now and focus on implementing click boards based on UART, GPIO, I2C and SPI classes considering the time constraint.</p>
<h2 id="detailed-implementation">Detailed Implementation</h2>
<h3 id="1-flashing-and-validating-the-zephyr-port-of-micropython">1. Flashing and validating the Zephyr port of MicroPython:</h3>
<p>The first step of the implementation of the project was actually building and flashing the MicroPython application firmware on BeagleConnect Freedom board.Starting off, the board needs to be upstreamed and present in the Zephyr repository, so that users can clone the repository on their local machine and flash it directly.For the same I worked on the Documentation and branding, alongwith adding the SPI node in the device tree file of the board for hardware interfacing.I also enabled the hardware features like SPI and I2C in the defconfig file.For the firmware to build the boards files were also supposed to be added in the MicroPython repository in the zephyr port section.For the same I opened 2 pull requests:</p>
<ol>
<li>Making necessary changes to board files in Zephyr repository: <a href="https://github.com/jadonk/zephyr/pull/9">https://github.com/jadonk/zephyr/pull/9</a></li>
<li>Adding Board and enabling hardware features in MicroPython repository: <a href="https://github.com/micropython/micropython/pull/7696">https://github.com/micropython/micropython/pull/7696</a></li>
</ol>
<p>Followed by this the flashed application firmware was also tested by performing certain basic Python operations and blinking LEDs, both on board and externally.</p>
<h3 id="2-gpio-class">2. GPIO Class:</h3>
<p>Taking the GPIO class into use I was able to run 2 click boards directly, writing their respective driver codes. I also implemented 2 click baords based on the PWM class by applying minimal delay using GPIO pins.</p>
<ol>
<li><a href="https://www.mikroe.com/relay-click">Relay click</a>: Was able to take the 2 relays on board into use by enabling and disabling them.</li>
<li><a href="https://www.mikroe.com/water-detect-click#:~:text=Downloads-,Water%20Detect%20click%20is%20used%20for%20detecting%20water%20and%20other,signaling%20the%20presence%20of%20liquid.&amp;text=Any%20time%20Water%20Detect%20click,will%20send%20you%20an%20SMS.">Water detect click</a>: Was able to detect the presence of water on board,returning 0 in absence and 1 in presence of water.</li>
<li><a href="https://www.mikroe.com/haptic-2-click">Haptic 2 click</a>: Operated a coin vibration motor using the motor driver of the click board.</li>
<li><a href="https://www.mikroe.com/buzz-2-click">Buzz 2 click</a>: Could get the Buzzer to work, emitting sound at maximum pitch.</li>
</ol>
<h3 id="3-i2c-class">3. I2C Class:</h3>
<p>Both the click boards were successfully implemented on the I2C class. Wrote driver code for the 2 click boards operating on this peripheral to get the required readings from them.</p>
<ol>
<li><a href="https://www.mikroe.com/temphum-13-click">Temperatre and Humiditiy 13 click</a>: The click board accurately returned Temperature and Humidity values.</li>
<li><a href="https://www.mikroe.com/air-quality-4-click">Air quality 4 click</a>: Could get the Total volatile organic compounds (TVOC)  and CO2 equivalent readings accurately and tested it extensively in various scenarios.</li>
</ol>
<h3 id="4-uart-class">4. UART Class:</h3>
<p>Implementing boards on UART and SPI class turned out to be blockers in this project.Tested out the read and write operations by sending data from BeagleConnect Freedom to other board and observed output on serial monitor. I wrote the driver class for the GPS click and Ultrasonic click also getting them verified from the MicroPython community, however could not get the desired output from them.</p>
<ol>
<li><a href="https://www.mikroe.com/gps-click">GPS click</a>: Wrote the driver code for the GPS click to receive GPGGA data,however could not receive and print the GPGGA sentence.</li>
<li><a href="https://www.mikroe.com/ultrasonic-2-click">Ultrasonic 2 click</a>: Wrote driver code to print the distance,however my code prints 0&rsquo;s only.</li>
</ol>
<p>To tackle the problems encountered I tried using a logic analyzer, probing both RX and TX lines however observed that there was no activity on the RX side of the board.For the GPS click along with the logic analyzer I also tried debugging on the hardware side, by attaching an antenna and by using an alternative GPS, like the <a href="https://www.adafruit.com/product/746">Adafruit Ultimate GPS</a>.
Also observed that the UART class was a work under progress,some methods like uart.init() used for intitialising the baud rate were not implemented.</p>
<h3 id="5-spi-class">5. SPI Class:</h3>
<p>Was able to write a driver code for the <a href="https://www.mikroe.com/accel-10-click">Accel 10 click</a>,however learned towards the end of my project timeline that SPI class for the particular port could only be initalised.Read and write operations of registers could not be performed,due to which could not run the click boards on this peripheral class.</p>
<h3 id="6-documentation">6. Documentation:</h3>
<p>This was the first time someone was using the Zephyr port of MicroPython so extensively and hence effective documentation was a very important apsect of this project.I documented both I2C and GPIO classes  implementation from ground up including the basics and how to&rsquo;s required, like building and flashing the application firmware.
All the driver code I have written is present in the Github repository.I also uploaded videos on Youtube with explanation of all the click boards I was able to run.</p>
<ol>
<li>Playlist of Youtube Videos: <a href="https://www.youtube.com/watch?v=x1hBazDr2Bk&amp;list=PLbZw2G3ld0D471Cp4zPe0opPVPxQNkkxe">https://www.youtube.com/watch?v=x1hBazDr2Bk&amp;list=PLbZw2G3ld0D471Cp4zPe0opPVPxQNkkxe</a></li>
<li>Posts on blog: https: <a href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/">https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/</a></li>
<li>Github repository: <a href="https://github.com/Yadnik1/Examples-Zephyr-port-of-MicroPython-">https://github.com/Yadnik1/Examples-Zephyr-port-of-MicroPython-</a></li>
</ol>
<h2 id="benefits">Benefits</h2>
<p>With this project the users of  BeagleConnect Freedom or any other users working on the Zephyr Port of MicroPython will be able be able to take MicroPython effectively into use for building their application.With the work done on this project there is enough documentation suggesting the differences between the Zephyr and generic port of MicroPython.Also drivers for some sensor ICs were written for the first time under this project.Users from the zephyr community can also take instances from this project when using MicroPython on boards having Zephyr support increasing the reach of MicroPython multifold.
Under this project MicroPython code was written for the first time for the Mickroe Click boards, generally working in C language.
With the various questions I asked on <a href="https://forum.micropython.org/viewforum.php?f=15&amp;sid=8a12f6c8724db72a1f2c48fdd011c73e">forums</a>, it will also make it easier for Zephyr port users to locate the state of the project and clear their doubts since no official documentation for this port exists apart from the Readme file available on the MicroPython repository.</p>
<h2 id="conclusion">Conclusion</h2>
<p>I will  continue to support this project in the future, take care of any bugs, issues and will continue implementing additional features whenever required.I will also work post GSoC to complete the missed goals of this project.
It was a great journey and I did get to learn a lot working in this project.These 10 weeks have been a great learning experience. I would like to thank BeagleBoard.org Foundation and Google for giving me such an amazing opportunity. Furthermore, I would like to thank my mentors Jason,Deepak and Tim for their constant support and guidance, also the members of BeagleBoard.org Foundation, namely Cathy ,Vaishnav, and fellow participants whom I also learnt a lot from.</p>
<h2 id="future-improvements">Future Improvements</h2>
<ol>
<li>In this GSoC I could not focus much on PWM and ADC classes as the priority was to implement the remaining classes for which driver code had been more or less written.Post GSoC I would be looking into this.</li>
<li>Having dedicated board and SoC files for CC1352P for Zephyr Project would be very beneficial in the long run.</li>
<li>On discussing with Mentors and Adafruit community there is potential of a dedicated CircuitPython port for BeagleConnect Freedom.</li>
</ol>
<h2 id="references">References</h2>
<p>This is a curated collection of links I used throughout the project:</p>
<p><a href="https://github.com/micropython/micropython/blob/master/ports/zephyr/README.md">https://github.com/micropython/micropython/blob/master/ports/zephyr/README.md</a>
<a href="https://github.com/MikroElektronika/mikrosdk_click_v2/tree/master/clicks">https://github.com/MikroElektronika/mikrosdk_click_v2/tree/master/clicks</a>
<a href="https://github.com/mcauser/awesome-micropython">https://github.com/mcauser/awesome-micropython</a>
<a href="https://github.com/jadonk/beagle_connect_zephyr_board">https://github.com/jadonk/beagle_connect_zephyr_board</a>
<a href="https://docs.micropython.org/en/latest/">https://docs.micropython.org/en/latest/</a>
<a href="https://docs.zephyrproject.org/latest/">https://docs.zephyrproject.org/latest/</a></p>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fyadnik1.github.io%2fYadnik1-GSoC-2021.github.io%2fpost%2fproject-report-for-gsoc-2021%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2fyadnik1.github.io%2fYadnik1-GSoC-2021.github.io%2fpost%2fproject-report-for-gsoc-2021%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2fyadnik1.github.io%2fYadnik1-GSoC-2021.github.io%2fpost%2fproject-report-for-gsoc-2021%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2fyadnik1.github.io%2fYadnik1-GSoC-2021.github.io%2fpost%2fproject-report-for-gsoc-2021%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fyadnik1.github.io%2fYadnik1-GSoC-2021.github.io%2fpost%2fproject-report-for-gsoc-2021%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2fyadnik1.github.io%2fYadnik1-GSoC-2021.github.io%2fpost%2fproject-report-for-gsoc-2021%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/post/using-i2c-class-to-run-click-boards-on-beagleconnect-freedom/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/post/using-i2c-class-to-run-click-boards-on-beagleconnect-freedom/">Using I2C class to run Click Boards on BeagleConnect Freedom</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>


  
  
  
  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'Your Disqus shortname';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  

</div>

</div>
</div>
<script src="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/js/ui.js"></script>
<script src="https://yadnik1.github.io/Yadnik1-GSoC-2021.github.io/js/menus.js"></script>




<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'Your Google Analytics tracking ID', 'auto');
    ga('send', 'pageview');
  }
</script>







</body>
</html>

